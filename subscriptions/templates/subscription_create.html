{% extends "base.html" %}

{% block title %}新增訂閱 | {{ block.super }}{% endblock title %}
{% block content %}
<div class="content-section">
    <div class="row">
        <form action="." method="post" role="form" class="form-inline">
            {% csrf_token %}

            <input type="hidden" id="user" value="{{ user.id }}" name="user" />
            <select class="form-control" id="category" name="category" >
                {% for category in board_category %}
                <option value="{{ category.id }}">{{ category.category_cht_name }}</option>
                {% endfor %}
            </select>
            <select class="form-control" id="board" name="board" >
                {% for item in board %}
                <option value="{{ item.id }}">{{ item.board_eng_name }}</option>
                {% endfor %}
            </select>
            <input class="form-control" type="text" id="keywords" name="keywords" placeholder="關鍵字" />

            <button type="submit" class="btn btn-default">新增</button>

        </form>
    </div>
</div>
{% endblock content %}

{% block script %}
<script>
    function appendBoardToOptionsBySelectedCategory(category){
        var $board = $('#board');
        $board.empty();
        {% for item in board %}
            if ( '{{ item.category_id}}'*1 === category){
                var board_name = '{{ item.board_eng_name }}';
                var board_id = '{{ item.id }}';
                $board.append($('<option></option>').attr('value', board_id).text(board_name));
            }
        {% endfor %}
    };

    $(document).ready(function(){
        appendBoardToOptionsBySelectedCategory(1);

        $('#category').change(function(){
            appendBoardToOptionsBySelectedCategory($(this).val()*1);
        });
    });

</script>

{% endblock script %}